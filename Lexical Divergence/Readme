# Sentence-Level Lexical Divergence Evaluation

This repository contains a robust implementation of a sentence-level evaluation metric designed to measure **lexical divergence in machine-translated texts**, particularly for political and humanitarian domains. It complements traditional MT metrics (e.g., BLEU, METEOR, BERTScore) by identifying whether **domain-critical terms** were preserved, omitted, or semantically drifted.

---

## ğŸ“ Repository Structure

â”œâ”€â”€ Spanish_to_English/
â”‚ â”œâ”€â”€ Deep/
â”‚ â”œâ”€â”€ DeepL/
â”‚ â”œâ”€â”€ Google_API/
â”‚ â””â”€â”€ OPUS/

â”œâ”€â”€ Arabic_to_English/
â”‚ â”œâ”€â”€ Deep/
â”‚ â”œâ”€â”€ DeepL/
â”‚ â”œâ”€â”€ Google_API/
â”‚ â””â”€â”€ OPUS/



Each subfolder includes a `sentence_pairs.csv` file containing original and machine-translated sentence pairs.

---

## ğŸ§© Functionality Overview

The main script performs the following steps:

1. **Loads sentence pairs** (Original vs. MT).
2. **Identifies missing or altered domain terms** using a reference lexicon (e.g., conflict or political terminology).
3. For each missing term:
   - Computes the **closest semantic match** in the MT sentence using `ConfliBERT` embeddings.
   - Assigns a score:

     ```
     Lexical_Score = 0.7 Ã— CosineSimilarity + 0.3 Ã— ConflictLexiconMatch
     ```

4. **Classifies** each sentence as:
   - `Acceptable`
   - `Divergence`

   Using:
   - A **Gaussian Mixture Model (GMM)**-based threshold
   - A **static threshold** (default = 0.60)

5. **Generates outputs**, including:
   - ğŸ“Š Lexical score distributions
   - ğŸ“¦ Summary statistics
   - ğŸ“Œ Top reasons for divergence

---

## ğŸ§¾ Input Format

Each `sentence_pairs.csv` must contain:

| Original_EN                     | MT_EN                            |
|--------------------------------|----------------------------------|
| The ceasefire was violated...  | The truce was broken...          |
| Protesters gathered downtown...| Demonstrations erupted...        |

A domain-specific lexicon should be located at:

**`conflict_lexicon.csv`**:

| term        |
|-------------|
| ceasefire   |
| protest     |
| intervention|

---

## ğŸ§¾ Output Files

The following files are generated in `/output_lexical_gmm/` and `/output_lexical_static/`:

- `lexical_divergence_results.csv` â€“ Final classification results  
- `missing_terms_lexical.csv` â€“ Terms not found in MT outputs  
- `candidates_lexical.csv` â€“ Semantic match candidates and scores  
- `lexical_divergence_summary.csv` â€“ Aggregated metrics  

### ğŸ“Š Visualizations

- `lexical_score_distribution.png`  
- `bar_classification_comparison.png`  
- `boxplot_gmm_classification.png`  
- `top_explanation_flags.png`

---

## âš™ï¸ Dependencies

Install the required libraries:

```bash
pip install pandas numpy nltk scikit-learn matplotlib seaborn sentence-transformers unidecode

Also download the required NLTK resources:
import nltk
nltk.download('punkt')
nltk.download('wordnet')
nltk.download('stopwords')
